{
  "log": {
    "disabled": false,
    "level": "info",
    "output": "box.log",
    "timestamp": false
  },
  "dns":{
    "servers":[
      {"type":"https","tag":"direct-dns","server":"8.8.8.8"},
      {"type":"https","tag":"remote-dns","server":"8.8.8.8"}
    ],
    "rules":[
      {"action":"reject","method":"default","no_drop":false,"domain_suffix":[".xiaomi.com",".xiaomi.net",".miui.com",".mi.com","windowsupdate.com","windows.net","windows.com","footprintdns.com","office.com","msedge.net","a-msedge.net","skype.com","xbox.com","xboxlive.com","msftauth.net","msauth.net"]},
      {"action":"reject","method":"default","no_drop":false,"rule_set":"aff"}
    ],
    "final":"remote-dns",
    "strategy": "prefer_ipv4",
    "disable_cache": false,
    "disable_expire": false,
    "independent_cache": false,
    "reverse_mapping": false
  },
  "inbounds":[
    {
      "type":"tun",
      "tag":"tun-in",
      "interface_name":"tun0",
      "mtu":9000,
      "address":"172.19.0.1/30",
      "auto_route":true,
      "strict_route":true,
      "stack":"system",
      "platform":{"http_proxy":{"enabled":true,"server":"127.0.0.1","server_port":7890}}
    },
    {"type":"mixed","tag":"mixed-in","listen":"127.0.0.1","listen_port":7891}
  ],
  "outbounds":[
    {"type":"selector","tag":"qqoli","outbounds":["mmobi","{all}"],"default":"mmobi","interrupt_exist_connections":false,"domain_resolver":"remote-dns"},
    {"type":"urltest","tag":"mmobi","outbounds":["{all}"],"url":"https://www.gstatic.com/generate_204","interval":"5m","tolerance":15,"interrupt_exist_connections":false},
    {"type":"direct","tag":"direct","domain_resolver":"direct-dns"}
  ],
  "route":{
    "final":"qqoli",
    "auto_detect_interface":true,
    "override_android_vpn":true,
    "rules":[
      {"action":"sniff"},
      {"action":"resolve","strategy":"prefer_ipv4"},
      {"action":"hijack-dns","protocol":"dns"},
      {"action":"hijack-dns","port":53},      
      {"action":"reject","method":"default","no_drop":false,"protocol":"quic"},
      {"action":"reject","method":"default","no_drop":false,"protocol":"stun"},
      {"action":"reject","method":"default","no_drop":false,"ip_cidr":["224.0.0.0/3","10.10.34.0/24"]},
      {"action":"reject","method":"default","no_drop":false,"source_ip_cidr":["224.0.0.0/3","10.10.34.0/24"]},
      {"action":"reject","method":"default","no_drop":false,"domain_suffix":[".xiaomi.com",".xiaomi.net",".miui.com",".mi.com","windowsupdate.com","windows.net","windows.com","footprintdns.com","office.com","msedge.net","a-msedge.net","skype.com","xbox.com","xboxlive.com","msftauth.net","msauth.net"]},
      {"action":"reject","method":"default","no_drop":false,"type":"logical","mode":"and","rules":[{"network":"tcp"},{"port":853}]},
      {"action":"reject","method":"default","no_drop":false,"type":"logical","mode":"and","rules":[{"network":"udp"},{"port":443}]},
      {"action":"reject","method":"default","no_drop":false,"rule_set":["aff","yun"]},
      {"action":"route","outbound":"direct","ip_is_private":true},
      {"action":"route","outbound":"direct","domain_suffix":".ir"},
      {"action":"route","outbound":"direct","rule_set":["xal","loo"]},
      {"action":"route","outbound":"qqoli","rule_set":["oki","doki"]}
    ],
    "rule_set":[
      {
        "type":"remote",
        "tag":"aff",
        "format":"binary",
        "url":"https://raw.githubusercontent.com/liketolivefree/kobabi/main/aff.srs",
        "download_detour":"direct"
      },
      {
        "type":"remote",
        "tag":"yun",
        "format":"binary",
        "url":"https://raw.githubusercontent.com/liketolivefree/kobabi/main/yun.srs",
        "download_detour":"direct"
      },
      {
        "type":"remote",
        "tag":"oki",
        "format":"binary",
        "url":"https://raw.githubusercontent.com/liketolivefree/kobabi/main/oki.srs",
        "download_detour":"direct"
      },
      {
        "type":"remote",
        "tag":"doki",
        "format":"binary",
        "url":"https://raw.githubusercontent.com/liketolivefree/kobabi/main/doki.srs",
        "download_detour":"direct"
      },
      {
        "type":"remote",
        "tag":"xal",
        "format":"binary",
        "url":"https://raw.githubusercontent.com/liketolivefree/kobabi/main/xal.srs",
        "download_detour":"direct"
      },
      {
        "type":"remote",
        "tag":"loo",
        "format":"binary",
        "url":"https://raw.githubusercontent.com/liketolivefree/kobabi/main/loo.srs",
        "download_detour":"direct"
      }
    ]
  },
  "experimental":{
    "cache_file":{"enabled":true},
    "clash_api":{
      "external_controller":"127.0.0.1:9090",
      "external_ui":"dashboard",
      "external_ui_download_url":"https://gh-proxy.com/https://github.com/MetaCubeX/Yacd-meta/archive/gh-pages.zip",
      "external_ui_download_detour":"direct",
      "default_mode":"rule",
      "access_control_allow_origin":["http://127.0.0.1","https://yacd.metacubex.one"],
      "access_control_allow_private_network":true
    }
  }
}
